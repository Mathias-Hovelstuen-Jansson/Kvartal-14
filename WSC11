'
'
' Weatherstation visualisering
' Mathias Hovelstuen Jansson (mathiashjan@gmail.com)
' 06.08.2024
' +47 901 71 698
' Bravida.no
'
'

'--------------------------------------------------------------------------------------------------
'Datoer og internvariabler

Numeric Sol_SE, Sol_SW, Sol_NE, Sol_NW, Sol_Elv, LystNE, LystNW, LystSE, LystSW
'--------------------------------------------------------------------------------------------------
'Digitale innganger

'--------------------------------------------------------------------------------------------------
'Analoge innganger

Numeric Input Brightness_N			'sensor som måler hvor mye lys det er fra nord 
Numeric Input Brightness_S			'sensor som måler hvor mye lys det er fra sør
Numeric Input Brightness_E			'sensor som måler hvor mye lys det er fra øst
Numeric Input Brightness_W			'sensor som måler hvor mye lys det er fra vest
Numeric Input Twilight					'sensor som måler hvor mye lys det er fra skumring
Numeric Input LuxGrense				 'Egen verdi som bestemmer hvor mange lux som trengs før blindsene lukker
Numeric Input Wind_Speed				'Sensor som måler hvor hardt det blåser på værstasjonen
Numeric Input Wind_Grense			 'Egen satt grense på hvor hardt det skal blåse før blindsene skal gå ned


'--------------------------------------------------------------------------------------------------
'Digitale utganger
																							'2.ndre etasje
Numeric Output Blind_201_1
Numeric Output Blind_201_2
Numeric Output Blind_202_1
Numeric Output Blind_202_2
Numeric Output Blind_202_3
Numeric Output Blind_203_1
Numeric Output Blind_204_1
Numeric Output Blind_204_2
Numeric Output Blind_205_1
Numeric Output Blind_206_1
Numeric Output Blind_206_2
Numeric Output Blind_206_3
Numeric Output Blind_207_1
Numeric Output Blind_207_2
Numeric Output Blind_207_3
Numeric Output Blind_208_1
Numeric Output Blind_208_2
Numeric Output Blind_208_3
Numeric Output Blind_209_1
Numeric Output Blind_209_2
Numeric Output Blind_209_3

																							'3.dje etasje
Numeric Output Blind_301_1
Numeric Output Blind_301_2
Numeric Output Blind_301_3
Numeric Output Blind_301_4
Numeric Output Blind_302_1
Numeric Output Blind_302_2
Numeric Output Blind_302_3
Numeric Output Blind_303_1
Numeric Output Blind_303_2
Numeric Output Blind_304_1
Numeric Output Blind_304_2
Numeric Output Blind_304_3
Numeric Output Blind_305_1
Numeric Output Blind_305_2
Numeric Output Blind_305_3
Numeric Output Blind_305_4
Numeric Output Blind_306_1
Numeric Output Blind_307_1
Numeric Output Blind_307_2
Numeric Output Blind_307_3
Numeric Output Blind_307_4
Numeric Output Blind_308_1
Numeric Output Blind_308_2
Numeric Output Blind_309_1
Numeric Output Blind_309_2
Numeric Output Blind_310_1
Numeric Output Blind_310_2
Numeric Output Blind_310_3
Numeric Output Blind_311_1
Numeric Output Blind_311_2
Numeric Output Blind_312_1
Numeric Output Blind_312_2
Numeric Output Blind_313_1
Numeric Output Blind_313_2
Numeric Output Blind_314_1
Numeric Output Blind_314_2
Numeric Output Blind_314_3
Numeric Output Blind_314_4
Numeric Output Blind_315_1
Numeric Output Blind_315_2
Numeric Output Blind_315_3
Numeric Output Blind_315_4
Numeric Output Blind_316_1
Numeric Output Blind_316_2
Numeric Output Blind_317_1
Numeric Output Blind_317_2
																							'4.dje etasje
Numeric Output Blind_401_1
Numeric Output Blind_401_2
Numeric Output Blind_401_3
Numeric Output Blind_401_4
Numeric Output Blind_402_1
Numeric Output Blind_402_2
Numeric Output Blind_402_3
Numeric Output Blind_403_1
Numeric Output Blind_403_2
Numeric Output Blind_403_3
Numeric Output Blind_403_4
Numeric Output Blind_404_1
Numeric Output Blind_404_2
Numeric Output Blind_404_3
Numeric Output Blind_404_4
Numeric Output Blind_405_1
Numeric Output Blind_405_2
Numeric Output Blind_405_3
Numeric Output Blind_405_4
Numeric Output Blind_406_1
Numeric Output Blind_406_2
Numeric Output Blind_406_3
Numeric Output Blind_406_4
Numeric Output Blind_407_1
Numeric Output Blind_407_2
Numeric Output Blind_408_1
Numeric Output Blind_408_2
Numeric Output Blind_408_3
Numeric Output Blind_408_4
Numeric Output Blind_409_1
Numeric Output Blind_409_2
Numeric Output Blind_410_1
Numeric Output Blind_410_2
Numeric Output Blind_410_3
Numeric Output Blind_410_4
Numeric Output Blind_411_1
Numeric Output Blind_411_2
Numeric Output Blind_411_3
Numeric Output Blind_412_1
Numeric Output Blind_412_2
Numeric Output Blind_412_3
Numeric Output Blind_412_4
Numeric Output Blind_413_1
Numeric Output Blind_413_2
Numeric Output Blind_413_3

																							'5.te etasje
Numeric Output Blind_501_1
Numeric Output Blind_501_2
Numeric Output Blind_501_3
Numeric Output Blind_501_4
Numeric Output Blind_502_1
Numeric Output Blind_502_2
Numeric Output Blind_502_3
Numeric Output Blind_503_1
Numeric Output Blind_503_2
Numeric Output Blind_503_3
Numeric Output Blind_504_1
Numeric Output Blind_504_2
Numeric Output Blind_504_3
Numeric Output Blind_505_1
Numeric Output Blind_505_2
Numeric Output Blind_505_3
Numeric Output Blind_505_4
Numeric Output Blind_506_1
Numeric Output Blind_506_2
Numeric Output Blind_507_1
Numeric Output Blind_507_2
Numeric Output Blind_508_1
Numeric Output Blind_508_2
Numeric Output Blind_508_3
Numeric Output Blind_509_1
Numeric Output Blind_509_2
Numeric Output Blind_509_3
Numeric Output Blind_510_1
Numeric Output Blind_510_2
Numeric Output Blind_510_3
Numeric Output Blind_511_1
Numeric Output Blind_511_2
Numeric Output Blind_511_3
Numeric Output Blind_511_4
Numeric Output Blind_512_1
Numeric Output Blind_512_2
Numeric Output Blind_512_3
Numeric Output Blind_512_4
Numeric Output Blind_514_1
Numeric Output Blind_514_2
Numeric Output Blind_514_3
Numeric Output Blind_515_1
Numeric Output Blind_516_1
Numeric Output Blind_516_2
Numeric Output Blind_517_1
Numeric Output Blind_517_2
Numeric Output Blind_517_3
Numeric Output Blind_517_4
Numeric Output Blind_518_1
Numeric Output Blind_518_2
Numeric Output Blind_518_3
Numeric Output Blind_518_4
Numeric Output Blind_519_1
Numeric Output Blind_519_2
Numeric Output Blind_519_3
Numeric Output Blind_519_4
Numeric Output Blind_520_1
Numeric Output Blind_520_2
Numeric Output Blind_520_3
Numeric Output Blind_521_1
Numeric Output Blind_521_2
Numeric Output Blind_521_3
Numeric Output Blind_521_4


'--------------------------------------------------------------------------------------------------
'Analoge og dato utganger

Datetime Output LastRunDateTime                  ' Debug helper, indikasjon fra når scriptet ble sist kjørt
'--------------------------------------------------------------------------------------------------
'String utganger

'--------------------------------------------------------------------------------------------------
' Indikasjon fra siste script cycle

LastRunDateTime = Date 

'--------------------------------------------------------------------------------------------------
' Hvis det snittet til de to sidene som blir plusset sammen er høyere enn brukersatt grense samtidig som vinden ute er under grensen så åpner blindsene mens hvis ikke så lukker de

If (Brightness_N + Brightness_E)/2 >= LuxGrense Then	
	Set LystNE = 0
Else
	Set LystNE = 100
Endif

If (Brightness_S + Brightness_W)/2 >= LuxGrense Then	
	Set LystSW = 0
Else
	Set LystSW = 100
Endif

If (Brightness_S + Brightness_E)/2 >= LuxGrense Then	
	Set LystSE = 0
Else
	Set LystSE = 100
Endif


If (Brightness_N + Brightness_W)/2 >= LuxGrense Then	
	Set LystNW = 0
Else
	Set LystNW = 100
Endif


'--------------------------------------------------------------------------------------------------

'Alle blindsene og hvilken rettning de peker imot sortert etter etasje og nummer

								' 2.dre etasje 
Set Blind_201_1 = LystNW
Set Blind_201_2 = LystNW

Set Blind_202_1 = LystNW
Set Blind_202_2 = LystNW
Set Blind_202_3 = LystNW

Set Blind_203_1 = LystNW

Set Blind_204_1 = LystNW
Set Blind_204_2 = LystNW

Set Blind_205_1 = LystNE

Set Blind_206_1 = LystSE
Set Blind_206_2 = LystSE
Set Blind_206_3 = LystSE

Set Blind_207_1 = LystSE
Set Blind_207_2 = LystSE
Set Blind_207_3 = LystSE

Set Blind_208_1 = LystSE
Set Blind_208_2 = LystSE
Set Blind_208_3 = LystSE

Set Blind_209_1 = LystSE



								'3dje etasje
Set Blind_301_1 = LystNE
Set Blind_301_2 = LystNE
Set Blind_301_3 = LystNE
Set Blind_301_4 = LystNE

Set Blind_302_1 = LystNE
Set Blind_302_2 = LystNE
Set Blind_302_3 = LystNE

Set Blind_303_1 = LystNE
Set Blind_303_2 = LystNE

Set Blind_304_1 = LystNE
Set Blind_304_2 = LystNE
Set Blind_304_3 = LystNE

Set Blind_305_1 = LystNE
Set Blind_305_2 = LystNE
Set Blind_305_3 = LystNE
Set Blind_305_4 = LystNE

Set Blind_306_1 = LystNE

Set Blind_307_1 = LystNE
Set Blind_307_2 = LystNE
Set Blind_307_3 = LystNE
Set Blind_307_4 = LystNE

Set Blind_308_1 = LystNW
Set Blind_308_2 = LystNW

Set Blind_309_1 = LystNE
Set Blind_309_2 = LystNE

Set Blind_310_1 = LystNE
Set Blind_310_2 = LystNE
Set Blind_310_3 = LystNE

Set Blind_311_1 = LystNE
Set Blind_311_2 = LystNE

Set Blind_312_1 = LystNW
Set Blind_312_2 = LystNW

Set Blind_313_1 = LystNW
Set Blind_313_2 = LystNW

Set Blind_314_1 = LystNW
Set Blind_314_2 = LystNW
Set Blind_314_3 = LystNW
Set Blind_314_4 = LystNW

Set Blind_315_1 = LystSE
Set Blind_315_2 = LystSE
Set Blind_315_3 = LystSE
Set Blind_315_4 = LystSE

Set Blind_316_1 = LystSE
Set Blind_316_2 = LystSE

Set Blind_317_1 = LystSE
Set Blind_317_2 = LystSE




								'4dje. etasje
Set Blind_401_1 = LystNE
Set Blind_401_2 = LystNE
Set Blind_401_3 = LystNE
Set Blind_401_4 = LystNE

Set Blind_402_1 = LystNE
Set Blind_402_2 = LystNE
Set Blind_402_3 = LystNE

Set Blind_403_1 = LystNE
Set Blind_403_2 = LystNE
Set Blind_403_3 = LystNE
Set Blind_403_4 = LystNE

Set Blind_404_1 = LystNE
Set Blind_404_2 = LystNE
Set Blind_404_3 = LystNE
Set Blind_404_4 = LystNE

Set Blind_405_1 = LystNE
Set Blind_405_2 = LystNE
Set Blind_405_3 = LystNE
Set Blind_405_4 = LystNE

Set Blind_406_1 = LystNE
Set Blind_406_2 = LystNE
Set Blind_406_3 = LystNE
Set Blind_406_4 = LystNE

Set Blind_407_1 = LystNE
Set Blind_407_2 = LystNE

Set Blind_408_1 = LystNE
Set Blind_408_2 = LystNE
Set Blind_408_3 = LystNE
Set Blind_408_4 = LystNE

Set Blind_409_1 = LystSE
Set Blind_409_2 = LystSE

Set Blind_410_1 = LystNW
Set Blind_410_2 = LystNW
Set Blind_410_3 = LystNW
Set Blind_410_4 = LystNW

Set Blind_411_1 = LystNW
Set Blind_411_2 = LystNW
Set Blind_411_3 = LystNW

Set Blind_412_1 = LystNW
Set Blind_412_2 = LystNW
Set Blind_412_3 = LystNW
Set Blind_412_4 = LystNW

Set Blind_413_1 = LystSE
Set Blind_413_2 = LystSE
Set Blind_413_3 = LystSE



								'5.te etasje
Set Blind_501_1 = LystNW
Set Blind_501_2 = LystNW
Set Blind_501_3 = LystNW
Set Blind_501_4 = LystNW

Set Blind_502_1 = LystNW
Set Blind_502_2 = LystNW
Set Blind_502_3 = LystNW

Set Blind_503_1 = LystNW
Set Blind_503_2 = LystNW
Set Blind_503_3 = LystNW

Set Blind_504_1 = LystNW
Set Blind_504_2 = LystNW
Set Blind_504_3 = LystNW

Set Blind_505_1 = LystNW
Set Blind_505_2 = LystNW
Set Blind_505_3 = LystNW
Set Blind_505_4 = LystNW

Set Blind_506_1 = LystNE
Set Blind_506_2 = LystNE

Set Blind_507_1 = LystNE
Set Blind_507_2 = LystNE

Set Blind_508_1 = LystNE
Set Blind_508_2 = LystNE
Set Blind_508_3 = LystNE

Set Blind_509_1 = LystNE
Set Blind_509_2 = LystNE
Set Blind_509_3 = LystNE

Set Blind_510_1 = LystNE
Set Blind_510_2 = LystNE
Set Blind_510_3 = LystNE

Set Blind_511_1 = LystNW
Set Blind_511_2 = LystNW
Set Blind_511_3 = LystNW
Set Blind_511_4 = LystNW

Set Blind_512_1 = LystNW
Set Blind_512_2 = LystNW
Set Blind_512_3 = LystNW
Set Blind_512_4 = LystNW

Set Blind_514_1 = LystNW
Set Blind_514_2 = LystNW
Set Blind_514_3 = LystNW

Set Blind_515_1 = LystNW

Set Blind_516_1 = LystNW
Set Blind_516_2 = LystNW

Set Blind_517_1 = LystNE
Set Blind_517_2 = LystNE
Set Blind_517_3 = LystNE
Set Blind_517_4 = LystNE

Set Blind_518_1 = LystNE
Set Blind_518_2 = LystNE
Set Blind_518_3 = LystNE
Set Blind_518_4 = LystNE

Set Blind_519_1 = LystSE
Set Blind_519_2 = LystSE
Set Blind_519_3 = LystSE
Set Blind_519_4 = LystSE

Set Blind_520_1 = LystSE
Set Blind_520_2 = LystSE
Set Blind_520_3 = LystSE

Set Blind_521_1 = LystSE
Set Blind_521_2 = LystSE
Set Blind_521_3 = LystSE
Set Blind_521_4 = LystSE

